<!DOCTYPE html>
<html lang="pt-br">

<head>
    <link rel="shortcut icon" href="../assets/icon/icon.png" type="image/x-icon">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eorzea Analytics | Dominios </title>
    <link rel="stylesheet" href="../css/cards.css">
    <script src="../js/sessao.js"></script>
    <script src="../js/alerta.js"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
</head>

<body>
    <div class="overlay">
        <div class="janela">
            <div class="header-left">
                <h1>Eorzea Analytics</h1>

                <div class="hello">
                    <h3>Olá, <span id="b_usuario">Aventureiro</span>!</h3>
                </div>

                <div class="btn-nav">
                    <h3>Domínios</h3>
                </div>

                <div class="btn-nav-white">
                    <a href="./dashboard.html">
                        <h3>Métricas</h3>
                    </a>
                </div>

                <div class="btn-nav-white">
                    <a href="./mural.html">
                        <h3> Anúncios da Guilda</h3>
                    </a>
                </div>

                <div class="btn-logout" onclick="limparSessao()">
                    <h3>Sair</h3>
                </div>
            </div>

            <section>

                Seu apelido:

                <div class="nickname" id="spaceNick"></div>


            </section>

            <canvas id="dashboard">
        </div>
</body>

<script>

    b_usuario.innerHTML = sessionStorage.NOME_USUARIO;

    // Ajustar fetch, inserir imagens no banco de dados ou via lista. 
    // KPI para media de poder da classe, via calculo e divisao do total de atributos.

    function obterDadosPerfil() {
        fetch(`/classe/classes/`,
            { cache: 'no-store' }).then(function (response) {
                if (response.ok) {
                    response.json().then(function (classe) {
                        console.log(`Dados recebidos: ${JSON.stringify(classe)}`);
                        classe.reverse();

                        showCharacter(classe);

                    });
                } else {
                    console.error('Nenhum dado encontrado ou erro na API');
                }
            })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            })
    };

    function showCharacter(classe) {
    let labels = ['Força', 'Destreza', 'Vitalidade', 'Inteligência'];
    
    let dados = {
        labels: labels,
        datasets: [{
            label: classe[0].nome,
            data: [
                classe[0].forca,
                classe[0].destreza, 
                classe[0].vitalidade,
                classe[0].inteligencia
            ],
            fill: true,
            backgroundColor: 'rgba(255, 99, 132, 0.2)',
            borderColor: 'rgb(255, 99, 132)',
            pointBackgroundColor: 'rgb(255, 99, 132)',
            pointBorderColor: '#fff',
            pointHoverBackgroundColor: '#fff',
            pointHoverBorderColor: 'rgb(255, 99, 132)'
        }]
    };

    const configRacas = {
        type: 'radar',
        data: dados,
    };

    let dashboardRaces = new Chart(
        document.getElementById('dashboard'),
        configRacas
    );
}
    obterDadosPerfil();

</script>

</html>